============================================
Account Invoice - Invoice2data import (GRAP)
============================================

.. 
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! source digest: sha256:58c90079fd6123df51d189786086a0e275690aa912be9a23746c384ab86ae973
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png
    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html
    :alt: License: AGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-grap%2Fgrap--odoo--business--supplier--invoice-lightgray.png?logo=github
    :target: https://github.com/grap/grap-odoo-business-supplier-invoice/tree/12.0/account_invoice_invoice2data
    :alt: grap/grap-odoo-business-supplier-invoice

|badge1| |badge2| |badge3|

This module is a module to analyze and provides tools to help purchasers
to change Odoo supplier invoices when they receives the invoice from the supplier.

It is helpull in the following Use Case:

- You create purchase orders with many lines in Odoo to generate and send the purchase order to the
  supplier, via Odoo.
- you change quantities in some picking lines when you receive the goods and confirm the picking.
- you generate a draft supplier invoice, based on the products you received.
  (Invoice Policy : Base on delivery)

- Then you have to compare the draft theoritical invoice with the real supplier invoice
  and apply changes in the theoritical invoice to match with the real supplier invoice.

**Reflections regarding community work**

This module is an alternative to OCA modules, mainly ``account_invoice_import_invoice2data``.
The reasons of the development of a specific module are the following :

- To use the OCA solution, we need to install 9 modules for a total of 2500 lines of code.
  ``account_invoice_import``, ``account_invoice_import_invoice2data``, ``unece``, etc...
  while this module contains less than 300 lines of python code.

- The current invoice2data OCA modules doesn't handle line analysis. A Work In Progress
  is present since April 2022 here https://github.com/OCA/edi/ for the V14 version.
  It is unmerged, not available for GRAP branches (V12 / V16) and doesn't handle multiple
  discounts.

- The OCA wizard is very complex, because it handles a lot of use cases, while the
  wizard of this module is very simple and handles all the use cases of the workflow
  "Update the odoo invoice, based on supplier invoice".

+-----------------------+---------------------+-----------------------------------------+
| **Managed Suppliers**                                                                 |
+-----------------------+---------------------+-----------------------------------------+
|  Supplier Name        |  VAT Number         |  Website                                |
+=======================+=====================+=========================================+
|  Relais Vert          |  FR 72 352 867 493  |  https://www.relais-vert.com/           |
+-----------------------+---------------------+-----------------------------------------+
|  Ekibio               |  FR 30 345 052 286  |  https://www.ekibio.fr/                 |
+-----------------------+---------------------+-----------------------------------------+

**Table of contents**

.. contents::
   :local:

Usage
=====

Consider the following use case.

**The PDF Invoice sent by your supplier**

.. figure:: https://raw.githubusercontent.com/grap/grap-odoo-business-supplier-invoice/12.0/account_invoice_invoice2data/static/description/initial_supplier_invoice.png

**The Odoo Invoice generated from the Purchase Order**

.. figure:: https://raw.githubusercontent.com/grap/grap-odoo-business-supplier-invoice/12.0/account_invoice_invoice2data/static/description/initial_odoo_invoice.png

* Go to "Invoicing > Vendors > Bills"

* Select an invoice and click on "Action > Update Based on the PDF of the supplier"

1. PDF Selection

    * Click "Upload your file" to select a PDF
    * Click on "Import" button

    .. figure:: https://raw.githubusercontent.com/grap/grap-odoo-business-supplier-invoice/12.0/account_invoice_invoice2data/static/description/wizard_step_1_pdf_import.png

2. Product mapping

    * The wizard will guess producs, based on the ``product_code`` of the selected supplier.

    * If the supplierinfo is not found, a step ask to mention which product corresponds
      to the invoice line.
      you have to link each supplier invoice line to an existing product (or create a new one).
    * Click on "Map Products"

    .. figure:: https://raw.githubusercontent.com/grap/grap-odoo-business-supplier-invoice/12.0/account_invoice_invoice2data/static/description/wizard_step_2_product_mapping.png

3. Summary before update

    The last screen display all the changes that will be done on the Odoo invoice.

    For the lines present in the supplier invoice, it will create or update existing lines.
    The lines present in Odoo but not in the supplier invoice will be removed.

    * Finally, click on "Apply Changes"

    .. figure:: https://raw.githubusercontent.com/grap/grap-odoo-business-supplier-invoice/12.0/account_invoice_invoice2data/static/description/wizard_step_3_summary.png

**Impact on the PDF**

* The missing lines have been created.
* The different lines has been updated. (and a description of the change has been added)
* The extra lines has been disabled. (quantity has been set to 0.)
* All the lines has been reordered.

.. figure:: https://raw.githubusercontent.com/grap/grap-odoo-business-supplier-invoice/12.0/account_invoice_invoice2data/static/description/final_odoo_invoice_1_lines.png

Known issues / Roadmap
======================

**Work to do before sharing in OCA**

* Move in a dedicated module:
    * ``_get_extra_products`` in ``wizards/wizard_invoice2data_import_line.py``

* Remove dependencies to triple discount modules, if there have been introduced.

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/grap/grap-odoo-business-supplier-invoice/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us to smash it by providing a detailed and welcomed
`feedback <https://github.com/grap/grap-odoo-business-supplier-invoice/issues/new?body=module:%20account_invoice_invoice2data%0Aversion:%2012.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* GRAP

Contributors
~~~~~~~~~~~~

* Sylvain LE GAL <https://twitter.com/legalsylvain>

Maintainers
~~~~~~~~~~~

This module is part of the `grap/grap-odoo-business-supplier-invoice <https://github.com/grap/grap-odoo-business-supplier-invoice/tree/12.0/account_invoice_invoice2data>`_ project on GitHub.

You are welcome to contribute.
